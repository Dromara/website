{
  "filename": "config-zookeeper.md",
  "__html": "<h3>本地配置</h3>\n<ul>\n<li>\n<p>文件名为 : <code>hmily.yml</code>。</p>\n</li>\n<li>\n<p>路径： 默认路径为项目的 <code>resource</code>目录下，也可以使用 <code>-Dhmily.conf</code> 指定，也可以把配置放在 <code>user.dir</code> 目录下。\n优先级别 <code>-Dhmily.conf</code> &gt; <code>user.dir</code> &gt; <code>resource</code></p>\n</li>\n<li>\n<p>具体的全内容如下 : 注意设置 <code>hmily.server.configMode</code> = zookeeper</p>\n</li>\n<li>\n<p>框架的或首先根据你的 <code>zookeeper</code> 配置，然后从 <code>zookeeper</code> 获取配置</p>\n</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">hmily:</span>\n  <span class=\"hljs-attr\">server:</span>\n    <span class=\"hljs-attr\">configMode:</span> <span class=\"hljs-string\">zookeeper</span>\n    <span class=\"hljs-attr\">appName:</span> \n  <span class=\"hljs-comment\">#  如果server.configMode eq local 的时候才会读取到这里的配置信息.</span>\n\n<span class=\"hljs-attr\">remote:</span>\n  <span class=\"hljs-attr\">zookeeper:</span>\n    <span class=\"hljs-attr\">serverList:</span> <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span><span class=\"hljs-string\">:2181</span> <span class=\"hljs-comment\">#你的zookeeper服务地址，多个使用逗号分隔</span>\n    <span class=\"hljs-attr\">fileExtension:</span> <span class=\"hljs-string\">yml</span> <span class=\"hljs-comment\">#zookeeper上配置文件的格式（properties或者yml）二选一</span>\n    <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">/hmily/xiaoyu</span> <span class=\"hljs-comment\">#zookeeper上配置文件的路径</span>\n    <span class=\"hljs-attr\">update :</span>   <span class=\"hljs-comment\">#默认是false ，是否需要将本地的配置文件写到zookeeper</span>\n    <span class=\"hljs-attr\">updateFileName:</span>  <span class=\"hljs-comment\">#update属性为true时候 ，配置文件名称，位于项目的 resource文件夹下的yaml格式</span>\n</code></pre>\n<ul>\n<li>然后，你可以在上述的 <code>path</code> 配置路径下，去写入<code>hmily</code>框架所需要的配置，配置格式如果下（yml）：</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">hmily:</span>\n  <span class=\"hljs-attr\">config:</span>\n    <span class=\"hljs-attr\">appName:</span> \n    <span class=\"hljs-attr\">serializer:</span> <span class=\"hljs-string\">kryo</span>\n    <span class=\"hljs-attr\">contextTransmittalMode:</span> <span class=\"hljs-string\">threadLocal</span>\n    <span class=\"hljs-attr\">scheduledThreadMax:</span> <span class=\"hljs-number\">16</span>\n    <span class=\"hljs-attr\">scheduledRecoveryDelay:</span> <span class=\"hljs-number\">60</span>\n    <span class=\"hljs-attr\">scheduledCleanDelay:</span> <span class=\"hljs-number\">60</span>\n    <span class=\"hljs-attr\">scheduledPhyDeletedDelay:</span> <span class=\"hljs-number\">600</span>\n    <span class=\"hljs-attr\">scheduledInitDelay:</span> <span class=\"hljs-number\">30</span>\n    <span class=\"hljs-attr\">recoverDelayTime:</span> <span class=\"hljs-number\">60</span>\n    <span class=\"hljs-attr\">cleanDelayTime:</span> <span class=\"hljs-number\">180</span>\n    <span class=\"hljs-attr\">limit:</span> <span class=\"hljs-number\">200</span>\n    <span class=\"hljs-attr\">retryMax:</span> <span class=\"hljs-number\">10</span>\n    <span class=\"hljs-attr\">bufferSize:</span> <span class=\"hljs-number\">8192</span>\n    <span class=\"hljs-attr\">consumerThreads:</span> <span class=\"hljs-number\">16</span>\n    <span class=\"hljs-attr\">asyncRepository:</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-attr\">autoSql:</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-attr\">phyDeleted:</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-attr\">storeDays:</span> <span class=\"hljs-number\">3</span>\n    <span class=\"hljs-attr\">repository:</span> <span class=\"hljs-string\">mysql</span>\n\n<span class=\"hljs-attr\">repository:</span>\n  <span class=\"hljs-attr\">database:</span>\n    <span class=\"hljs-attr\">driverClassName:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n    <span class=\"hljs-attr\">url :</span>\n    <span class=\"hljs-attr\">username:</span>\n    <span class=\"hljs-attr\">password:</span>\n    <span class=\"hljs-attr\">maxActive:</span> <span class=\"hljs-number\">20</span>\n    <span class=\"hljs-attr\">minIdle:</span> <span class=\"hljs-number\">10</span>\n    <span class=\"hljs-attr\">connectionTimeout:</span> <span class=\"hljs-number\">30000</span>\n    <span class=\"hljs-attr\">idleTimeout:</span> <span class=\"hljs-number\">600000</span>\n    <span class=\"hljs-attr\">maxLifetime:</span> <span class=\"hljs-number\">1800000</span>\n  <span class=\"hljs-attr\">file:</span>\n    <span class=\"hljs-attr\">path:</span>\n    <span class=\"hljs-attr\">prefix:</span> <span class=\"hljs-string\">/hmily</span>\n  <span class=\"hljs-attr\">mongo:</span>\n    <span class=\"hljs-attr\">databaseName:</span>\n    <span class=\"hljs-attr\">url:</span>\n    <span class=\"hljs-attr\">userName:</span>\n    <span class=\"hljs-attr\">password:</span>\n  <span class=\"hljs-attr\">zookeeper:</span>\n    <span class=\"hljs-attr\">host:</span> <span class=\"hljs-string\">localhost:2181</span>\n    <span class=\"hljs-attr\">sessionTimeOut:</span> <span class=\"hljs-number\">1000</span>\n    <span class=\"hljs-attr\">rootPath:</span> <span class=\"hljs-string\">/hmily</span>\n  <span class=\"hljs-attr\">redis:</span>\n    <span class=\"hljs-attr\">cluster:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">sentinel:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">clusterUrl:</span>\n    <span class=\"hljs-attr\">sentinelUrl:</span>\n    <span class=\"hljs-attr\">masterName:</span>\n    <span class=\"hljs-attr\">hostName:</span>\n    <span class=\"hljs-attr\">port:</span>\n    <span class=\"hljs-attr\">password:</span>\n    <span class=\"hljs-attr\">maxTotal:</span> <span class=\"hljs-number\">8</span>\n    <span class=\"hljs-attr\">maxIdle:</span> <span class=\"hljs-number\">8</span>\n    <span class=\"hljs-attr\">minIdle:</span> <span class=\"hljs-number\">2</span>\n    <span class=\"hljs-attr\">maxWaitMillis:</span> <span class=\"hljs-number\">-1</span>\n    <span class=\"hljs-attr\">minEvictableIdleTimeMillis:</span> <span class=\"hljs-number\">1800000</span>\n    <span class=\"hljs-attr\">softMinEvictableIdleTimeMillis:</span> <span class=\"hljs-number\">1800000</span>\n    <span class=\"hljs-attr\">numTestsPerEvictionRun:</span> <span class=\"hljs-number\">3</span>\n    <span class=\"hljs-attr\">testOnCreate:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">testOnBorrow:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">testOnReturn:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">testWhileIdle:</span> <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-attr\">timeBetweenEvictionRunsMillis:</span> <span class=\"hljs-number\">-1</span>\n    <span class=\"hljs-attr\">blockWhenExhausted:</span> <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-attr\">timeOut:</span> <span class=\"hljs-number\">1000</span>\n\n<span class=\"hljs-attr\">metrics:</span>\n  <span class=\"hljs-attr\">metricsName:</span> <span class=\"hljs-string\">prometheus</span>\n  <span class=\"hljs-attr\">host:</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">9091</span>\n  <span class=\"hljs-attr\">async:</span> <span class=\"hljs-literal\">true</span>\n  <span class=\"hljs-attr\">threadCount :</span> <span class=\"hljs-number\">16</span>\n  <span class=\"hljs-attr\">jmxConfig:</span>\n</code></pre>\n<ul>\n<li>\n<p>注意 <code>repository</code>的配置是SPI的扩展方式，几种方式由你去选择一种，并不需要全部配置。</p>\n</li>\n<li>\n<p><code>metrics</code> 配置可有可无，如果不配置，则代表不开启<code>metrics</code></p>\n</li>\n</ul>\n",
  "link": "\\zh-cn\\docs\\hmily\\config-zookeeper.html",
  "meta": {
    "title": "Hmily-Config-Zookeeper",
    "keywords": "config",
    "description": "zookeeper配置中心模式"
  }
}