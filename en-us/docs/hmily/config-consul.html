<!DOCTYPE html>
<html lang="zh">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="dromara.org" />
	<meta name="description" content="dromara.org" />
	<!-- 网页标签标题 -->
	<title>dromara(Open source organization)</title>
	<link rel="shortcut icon" href="/img/docsite.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/en-us/index.html"><img class="logo" src="/img/dromara.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">中</span><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a href="/en-us/index.html" target="_self">Home</a><div class="sub-menu"><ul></ul></div></li><li class="menu-item menu-item-normal menu-item-normal-active"><a href="#">Document</a><div class="sub-menu"><ul><li><a href="/en-us/docs/soul/soul.html" target="_self">Soul</a></li><li><a href="/en-us/docs/hmily/index.html" target="_self">Hmily</a></li></ul></div></li><li class="menu-item menu-item-normal"><a href="/en-us/blog/index.html" target="_self">Blog</a><div class="sub-menu"><ul></ul></div></li><li class="menu-item menu-item-normal"><a href="/en-us/community/index.html" target="_self">Community</a><div class="sub-menu"><ul></ul></div></li></ul></div></div></header><section class="content-section"><div class="sidemenu" id="menu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>Soul</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/soul.html" target="_self">Home  </a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/team.html" target="_self">Team</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/db.html" target="_self">Database Design</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/config.html" target="_self">Config</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/dataSync.html" target="_self">DataSync</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/soul/metaData.html" target="_self">MetaData</a></li><li style="height:864px;overflow:hidden" class="menu-item menu-item-level-2"><span>User Document<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/setup.html" target="_self">Set up</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/soul-dict.html" target="_self">Dictionary management</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-handle.html" target="_self">Plugin handle explanation</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/user-http.html" target="_self">Http proxy</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/user-dubbo.html" target="_self">Dubbo proxy</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/user-springcloud.html" target="_self">Spring cloud proxy</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/user-sofa.html" target="_self">Sofa rpc proxy</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/selector.html" target="_self">Selector and Rule</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/user-dataSync.html" target="_self">Use data sync</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-contextpath.html" target="_self">Context-path plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-divide.html" target="_self">Divide Plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-dubbo.html" target="_self">Dubbo plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-springcloud.html" target="_self">Spring cloud plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-sofa.html" target="_self">Sofa plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-rateLimiter.html" target="_self">RateLimiter plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-hystrix.html" target="_self">Hystrix plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-sentinel.html" target="_self">Sentinel plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-resilience4j.html" target="_self">Resilience4j plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-monitor.html" target="_self">Monitor plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-waf.html" target="_self">Waf plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-sign.html" target="_self">Sign plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-rewrite.html" target="_self">Rewrite plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/plugin-websocket.html" target="_self">Websocket plugin</a></li></ul></li><li style="height:360px;overflow:hidden" class="menu-item menu-item-level-2"><span>Developer Guide<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-filter.html" target="_self">Custom filter </a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-plugin.html" target="_self">Custom plugin</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-file.html" target="_self">File and Image</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-iphost.html" target="_self">Custom parsing IP and Host</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-result.html" target="_self">Custom result</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-sign.html" target="_self">Custom sign algorithm</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-client.html" target="_self">Developer soul client</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-thread.html" target="_self">Thread</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/dev-netty.html" target="_self">Soul optimize</a></li></ul></li><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>Community<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/contributor.html" target="_self">Contributor</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/committer.html" target="_self">Committer</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/soul/code-conduct.html" target="_self">Code conduct</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body" id="doc-body"><h3>Local Configuration</h3>
<ul>
<li>
<p>File Name: <code>hmily.yml</code>。</p>
</li>
<li>
<p>Path: The default path is the <code>resource</code> directory of the project, which can be specified by <code>-Dhmily.conf</code>, and you can also put the configuration in <code>user.dir</code> directory.
Priority: <code>-Dhmily.conf</code> &gt; <code>user.dir</code> &gt; <code>resource</code></p>
</li>
<li>
<p>The specific contents are as follows : Notice setting <code>hmily.server.configMode = consul</code></p>
</li>
<li>
<p>The framework will pull the configuration according to your configured <code>consul</code>.</p>
</li>
</ul>
<pre><code class="language-yml"><span class="hljs-attr">hmily:</span>
  <span class="hljs-attr">server:</span>
    <span class="hljs-attr">configMode:</span> <span class="hljs-string">consul</span>
    <span class="hljs-attr">appName:</span> <span class="hljs-string">xxxxx</span>

<span class="hljs-attr">remote:</span>
  <span class="hljs-attr">consul:</span>
    <span class="hljs-attr">hostAndPort:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8500</span> <span class="hljs-comment"># consul service address</span>
    <span class="hljs-attr">hostAndPorts:</span> 
    <span class="hljs-attr">key:</span> <span class="hljs-string">test</span> <span class="hljs-comment"># the key of consul</span>
    <span class="hljs-attr">blacklistTimeInMillis:</span> <span class="hljs-number">6000</span>
    <span class="hljs-attr">fileExtension:</span> <span class="hljs-string">yml</span> <span class="hljs-comment"># the format of the configuration of consul (properties or yml)</span>
    <span class="hljs-attr">passive:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># enable automatic update</span>

</code></pre>
<ul>
<li>
<p>Pay attention to consul service address configuration, if it is cluster, please configure hostAndPorts Nodes, configure hostAndPort to standalone mode. You have to set one of them, if the two is empty, it will adopt cluster configuration.</p>
</li>
<li>
<p>And you need to add hmily configuration in the above configured key, the configuration is as follows:</p>
</li>
</ul>
<pre><code class="language-yml"><span class="hljs-attr">hmily:</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-attr">appName:</span> 
    <span class="hljs-attr">serializer:</span> <span class="hljs-string">kryo</span>
    <span class="hljs-attr">contextTransmittalMode:</span> <span class="hljs-string">threadLocal</span>
    <span class="hljs-attr">scheduledThreadMax:</span> <span class="hljs-number">16</span>
    <span class="hljs-attr">scheduledRecoveryDelay:</span> <span class="hljs-number">60</span>
    <span class="hljs-attr">scheduledCleanDelay:</span> <span class="hljs-number">60</span>
    <span class="hljs-attr">scheduledPhyDeletedDelay:</span> <span class="hljs-number">600</span>
    <span class="hljs-attr">scheduledInitDelay:</span> <span class="hljs-number">30</span>
    <span class="hljs-attr">recoverDelayTime:</span> <span class="hljs-number">60</span>
    <span class="hljs-attr">cleanDelayTime:</span> <span class="hljs-number">180</span>
    <span class="hljs-attr">limit:</span> <span class="hljs-number">200</span>
    <span class="hljs-attr">retryMax:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">bufferSize:</span> <span class="hljs-number">8192</span>
    <span class="hljs-attr">consumerThreads:</span> <span class="hljs-number">16</span>
    <span class="hljs-attr">asyncRepository:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">autoSql:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">phyDeleted:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">storeDays:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">repository:</span> <span class="hljs-string">mysql</span>

<span class="hljs-attr">repository:</span>
  <span class="hljs-attr">database:</span>
    <span class="hljs-attr">driverClassName:</span> <span class="hljs-string">com.mysql.jdbc.Driver</span>
    <span class="hljs-attr">url :</span>
    <span class="hljs-attr">username:</span>
    <span class="hljs-attr">password:</span>
    <span class="hljs-attr">maxActive:</span> <span class="hljs-number">20</span>
    <span class="hljs-attr">minIdle:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">connectionTimeout:</span> <span class="hljs-number">30000</span>
    <span class="hljs-attr">idleTimeout:</span> <span class="hljs-number">600000</span>
    <span class="hljs-attr">maxLifetime:</span> <span class="hljs-number">1800000</span>
  <span class="hljs-attr">file:</span>
    <span class="hljs-attr">path:</span>
    <span class="hljs-attr">prefix:</span> <span class="hljs-string">/hmily</span>
  <span class="hljs-attr">mongo:</span>
    <span class="hljs-attr">databaseName:</span>
    <span class="hljs-attr">url:</span>
    <span class="hljs-attr">userName:</span>
    <span class="hljs-attr">password:</span>
  <span class="hljs-attr">zookeeper:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost:2181</span>
    <span class="hljs-attr">sessionTimeOut:</span> <span class="hljs-number">1000</span>
    <span class="hljs-attr">rootPath:</span> <span class="hljs-string">/hmily</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">cluster:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">sentinel:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">clusterUrl:</span>
    <span class="hljs-attr">sentinelUrl:</span>
    <span class="hljs-attr">masterName:</span>
    <span class="hljs-attr">hostName:</span>
    <span class="hljs-attr">port:</span>
    <span class="hljs-attr">password:</span>
    <span class="hljs-attr">maxTotal:</span> <span class="hljs-number">8</span>
    <span class="hljs-attr">maxIdle:</span> <span class="hljs-number">8</span>
    <span class="hljs-attr">minIdle:</span> <span class="hljs-number">2</span>
    <span class="hljs-attr">maxWaitMillis:</span> <span class="hljs-number">-1</span>
    <span class="hljs-attr">minEvictableIdleTimeMillis:</span> <span class="hljs-number">1800000</span>
    <span class="hljs-attr">softMinEvictableIdleTimeMillis:</span> <span class="hljs-number">1800000</span>
    <span class="hljs-attr">numTestsPerEvictionRun:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">testOnCreate:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">testOnBorrow:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">testOnReturn:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">testWhileIdle:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">timeBetweenEvictionRunsMillis:</span> <span class="hljs-number">-1</span>
    <span class="hljs-attr">blockWhenExhausted:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">timeOut:</span> <span class="hljs-number">1000</span>

<span class="hljs-attr">metrics:</span>
  <span class="hljs-attr">metricsName:</span> <span class="hljs-string">prometheus</span>
  <span class="hljs-attr">host:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">9091</span>
  <span class="hljs-attr">async:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">threadCount :</span> <span class="hljs-number">16</span>
  <span class="hljs-attr">jmxConfig:</span>
</code></pre>
<ul>
<li>
<p>Notice that the configurations of <code>repository</code> are extensions of SPI, you can select one from those modes, which don't have to be configured all.</p>
</li>
<li>
<p><code>metrics</code> is optional; If it is not configured，it means you don't enable <code>metrics</code>.</p>
</li>
</ul>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/img/dromara.png"/><div class="cols-container"><div class="col col-12"><h3>Disclaimer</h3><p>Any unit or individual reprint all relevant information of this website, please indicate the source.</p></div><div class="col col-6"><dl><dt>Document</dt><dd><a href="/en-us/docs/soul/soul.html" target="_self">Overview </a></dd><dd><a href="/en-us/docs/soul/soul.html" target="_self">Stat up</a></dd><dd><a href="/en-us/docs/soul/soul.html" target="_self">Developer Guide</a></dd></dl></div><div class="col col-6"><dl><dt>Resource</dt><dd><a href="/en-us/blog/index.html" target="_self">Blog</a></dd><dd><a href="/en-us/community/index.html" target="_self">Community</a></dd></dl></div></div><div class="copyright"><span>Copyright ©2020 xiaoyu@apache.org by xiaoyu</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>