{
  "filename": "user-http.md",
  "__html": "<h2>Features</h2>\n<ul>\n<li>\n<p>In this chapter, the aim is to help Http Customer</p>\n</li>\n<li>\n<p>soul gateway uses divide plugin handling http request that invokded under soul-admin backgroud.</p>\n</li>\n<li>\n<p>Before we start, we should be aware of running the <code>soul-admin</code>, and <a href=\"setup.md\">Environment Setup</a> is OK。</p>\n</li>\n</ul>\n<h2>Setting up gateway proxy plugin for Http.</h2>\n<ul>\n<li>Add these dependencies in gateway's <code>pom.xml</code>：</li>\n</ul>\n<pre><code class=\"language-xml\">  <span class=\"hljs-comment\">&lt;!--if you use http proxy start this--&gt;</span>\n   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-plugin-divide<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.2.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n\n   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-plugin-httpclient<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.2.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>Of course, we need to restart the gateway.</li>\n</ul>\n<h2>integrate gateway with http request（springMVC user）</h2>\n<ul>\n<li>pls make sure divide plugin has opned under <code>soul-admin</code> background.</li>\n</ul>\n<h5>Soul-Client register methods。 （apply for SpringMvc,SpringBoot user）</h5>\n<ul>\n<li>\n<p>SpringBoot user</p>\n<ul>\n<li>add these dependencies in your local maven repository <code>pom.xml</code>:</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n         <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n         <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-client-springmvc<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n         <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.2.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>Add these config value in your yaml file ：</li>\n</ul>\n<pre><code class=\"language-yaml\">   <span class=\"hljs-attr\">soul:</span>\n     <span class=\"hljs-attr\">http:</span>\n       <span class=\"hljs-attr\">adminUrl:</span> <span class=\"hljs-string\">http://localhost:9095</span>\n       <span class=\"hljs-attr\">port:</span> <span class=\"hljs-string\">the</span> <span class=\"hljs-string\">port</span> <span class=\"hljs-string\">exposed</span> <span class=\"hljs-string\">by</span> <span class=\"hljs-string\">your</span> <span class=\"hljs-string\">application</span> <span class=\"hljs-string\">server</span>\n       <span class=\"hljs-attr\">contextPath:</span> <span class=\"hljs-string\">/http</span>\n       <span class=\"hljs-attr\">appName:</span> <span class=\"hljs-string\">http</span>\n       <span class=\"hljs-attr\">full:</span> <span class=\"hljs-literal\">false</span>  \n   <span class=\"hljs-comment\"># adminUrl: 'ip + port' that running on your soul-admin project, pls note that 'http://' is necessary.</span>\n   <span class=\"hljs-comment\"># port: your project port number</span>\n   <span class=\"hljs-comment\"># contextPath: the route prefix in soul gateway of your MVC project, such as /order ，/product etc，gateway will route with this.</span>\n   <span class=\"hljs-comment\"># appName：your application name，default value is`spring.application.name`.</span>\n   <span class=\"hljs-comment\"># full: set true means providing proxy service for your entire service, or only a few controller.</span>\n</code></pre>\n<ul>\n<li>SpringMvc user\n<ul>\n<li>add these dependensies in your local mavne repository <code>pom.xml</code>.:</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-client-springmvc<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.2.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>Inject these properties into your Spring beans XML file:</li>\n</ul>\n<pre><code class=\"language-xml\">   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">bean</span> <span class=\"hljs-attr\">id</span> =<span class=\"hljs-string\">\"springMvcClientBeanPostProcessor\"</span> ,<span class=\"hljs-attr\">class</span> =<span class=\"hljs-string\">\"org.dromara.soul.client.springmvc.init.SpringMvcClientBeanPostProcessor\"</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">constructor-arg</span>  <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"soulSpringMvcConfig\"</span>/&gt;</span>\n   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">bean</span>&gt;</span>\n   \n   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">bean</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"soulSpringMvcConfig\"</span>, <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"org.dromara.soul.client.springmvc.config.SoulSpringMvcConfig\"</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"adminUrl\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"http://localhost:9095\"</span>/&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"port\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"your port\"</span>/&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"contextPath\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"/your contextPath\"</span>/&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"appName\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"your name\"</span>/&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"full\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"false\"</span>/&gt;</span>\n   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">bean</span>&gt;</span>\n</code></pre>\n<ul>\n<li>\n<p>Add this annotation <code>@SoulSpringMvcClient</code> in your <code>controller</code> interface.</p>\n<ul>\n<li>\n<p>you can apply the annotation to class-level in a controller.the property of 'path' is prefix and '/**' will apply proxy service for entire interfaces.</p>\n</li>\n<li>\n<p>example: （1）： <code>/test/payment</code>, <code>/test/findByUserId</code> will be handled by proxy service.</p>\n</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-java\"> <span class=\"hljs-meta\">@RestController</span>\n <span class=\"hljs-meta\">@RequestMapping</span>(<span class=\"hljs-string\">\"/test\"</span>)\n <span class=\"hljs-meta\">@SoulSpringMvcClient</span>(path = <span class=\"hljs-string\">\"/test/**\"</span>)\n <span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">HttpTestController</span> </span>{\n     \n     <span class=\"hljs-meta\">@PostMapping</span>(<span class=\"hljs-string\">\"/payment\"</span>)\n     <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> UserDTO <span class=\"hljs-title\">post</span><span class=\"hljs-params\">(@RequestBody <span class=\"hljs-keyword\">final</span> UserDTO userDTO)</span> </span>{\n         <span class=\"hljs-keyword\">return</span> userDTO;\n     }\n  \n     <span class=\"hljs-meta\">@GetMapping</span>(<span class=\"hljs-string\">\"/findByUserId\"</span>)\n     <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> UserDTO <span class=\"hljs-title\">findByUserId</span><span class=\"hljs-params\">(@RequestParam(<span class=\"hljs-string\">\"userId\"</span>)</span> <span class=\"hljs-keyword\">final</span> String userId) </span>{\n         UserDTO userDTO = <span class=\"hljs-keyword\">new</span> UserDTO();\n         userDTO.setUserId(userId);\n         userDTO.setUserName(<span class=\"hljs-string\">\"hello world\"</span>);\n         <span class=\"hljs-keyword\">return</span> userDTO;\n     }      \n  }\n</code></pre>\n<ul>\n<li>example （2）：  <code>/order/save</code> will be handled by proxy service, but <code>/order/findById</code> won't。</li>\n</ul>\n<pre><code class=\"language-java\"> <span class=\"hljs-meta\">@RestController</span>\n <span class=\"hljs-meta\">@RequestMapping</span>(<span class=\"hljs-string\">\"/order\"</span>)\n <span class=\"hljs-meta\">@SoulSpringMvcClient</span>(path = <span class=\"hljs-string\">\"/order\"</span>)\n <span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">OrderController</span> </span>{\n \n     <span class=\"hljs-meta\">@PostMapping</span>(<span class=\"hljs-string\">\"/save\"</span>)\n     <span class=\"hljs-meta\">@SoulSpringMvcClient</span>(path = <span class=\"hljs-string\">\"/save\"</span>)\n     <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> OrderDTO <span class=\"hljs-title\">save</span><span class=\"hljs-params\">(@RequestBody <span class=\"hljs-keyword\">final</span> OrderDTO orderDTO)</span> </span>{\n         orderDTO.setName(<span class=\"hljs-string\">\"hello world save order\"</span>);\n         <span class=\"hljs-keyword\">return</span> orderDTO;\n     }\n\n     <span class=\"hljs-meta\">@GetMapping</span>(<span class=\"hljs-string\">\"/findById\"</span>)\n     <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> OrderDTO <span class=\"hljs-title\">findById</span><span class=\"hljs-params\">(@RequestParam(<span class=\"hljs-string\">\"id\"</span>)</span> <span class=\"hljs-keyword\">final</span> String id) </span>{\n         OrderDTO orderDTO = <span class=\"hljs-keyword\">new</span> OrderDTO();\n         orderDTO.setId(id);\n         orderDTO.setName(<span class=\"hljs-string\">\"hello world findById\"</span>);\n         <span class=\"hljs-keyword\">return</span> orderDTO;\n     }\n }\n</code></pre>\n<ul>\n<li>Kick off your project, your interface integrate with gateway.</li>\n</ul>\n<h2>integration gateway with http request（（other language，not springMvc）</h2>\n<ul>\n<li>\n<p>first of all, find the divide plugin in <code>soul-admin</code>, then add selctor and regulator which will compare and screen the flux.</p>\n</li>\n<li>\n<p>if you don't know how to config, pls refer to <a href=\"selector.md\">selector regulation introduction</a>。</p>\n</li>\n<li>\n<p>you can also develop your cutomized http-client，refer to <a href=\"dev-client.md\">multi-language Http client development</a>。</p>\n</li>\n</ul>\n<h2>User request</h2>\n<ul>\n<li>\n<p>Send the request as before, only two points need to notice.</p>\n</li>\n<li>\n<p>firstly，the domain name that requested before is your service, now need to replace with gateway's domain name.</p>\n</li>\n<li>\n<p>secondly，soul gateway needs a route prefix which comes from <code>contextPath</code>, it configured during the integration with gateway, you can change it freely in divide plugin of <code>soul-admin</code>, if your familiar with it.</p>\n</li>\n</ul>\n<pre><code class=\"language-yaml\">\n<span class=\"hljs-comment\"># for example, if you have a order service and it has a interface, the request url: http://localhost:8080/test/save</span>\n\n<span class=\"hljs-comment\"># Now need to change to:  http://localhost:9195/order/test/save</span>\n\n<span class=\"hljs-comment\"># We can see localhost:9195 is your gateway's ip port，default port number is 9195 ，/order is your contextPath which you configured with gateway.</span>\n\n<span class=\"hljs-comment\"># other parameters, the request method doesn't change.</span>\n\n<span class=\"hljs-comment\"># Any questions, pls join the group and we can talk about it.</span>\n\n</code></pre>\n<ul>\n<li>then you can visit, very easy and simple。</li>\n</ul>\n",
  "link": "\\en-us\\docs\\soul\\user-http.html",
  "meta": {
    "title": "Http Customer",
    "keywords": "soul",
    "description": "Http Customer"
  }
}