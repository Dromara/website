{
  "filename": "user-dataSync.md",
  "__html": "<h2>Features</h2>\n<ul>\n<li>\n<p>Data synchronization is the key of gateway high performance, which is to sync 'soul-admin' config data into the JVM memory of soul cluster.</p>\n</li>\n<li>\n<p>Implementation principles, pls refer to：<a href=\"dataSync.md\">dataSync</a>。</p>\n</li>\n<li>\n<p>In the article, the gateway is the environment you setup. please refer to：<a href=\"setup.md\">Environment Setup</a>.</p>\n</li>\n</ul>\n<h2>Websocket sync（default method，recommend）</h2>\n<ul>\n<li>\n<p>gateway setting（note:restart）</p>\n<ul>\n<li>Add these dependencies in <code>pom.xml</code>：</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">   <span class=\"hljs-comment\">&lt;!--soul data sync start use websocket--&gt;</span>\n   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-sync-data-websocket<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${last.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>add these config values in springboot yaml file:</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul :</span>\n    <span class=\"hljs-attr\">sync:</span>\n        <span class=\"hljs-attr\">websocket :</span>\n             <span class=\"hljs-attr\">urls:</span> <span class=\"hljs-string\">ws://localhost:9095/websocket</span>\n<span class=\"hljs-comment\">#urls: address of soul-admin，multi-address will be splitted with (,).</span>\n</code></pre>\n<ul>\n<li>soul-admin config, enable this parameter <code>--soul.sync.websocket=''</code> in soul admin, then restart service.</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul:</span>\n  <span class=\"hljs-attr\">sync:</span>\n     <span class=\"hljs-attr\">websocket:</span>\n</code></pre>\n<ul>\n<li>\n<p>When the connection is established, getting the full data once,then adding and upating data subsequently, which is a good performance.</p>\n</li>\n<li>\n<p>Support disconnection and reconnection (default 30 sec).</p>\n</li>\n</ul>\n<h2>zookeeper sync</h2>\n<ul>\n<li>\n<p>gateway setting（note: restart）</p>\n<ul>\n<li>Add these dependencies in <code>pom.xml</code>:</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">   <span class=\"hljs-comment\">&lt;!--soul data sync start use zookeeper--&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-sync-data-zookeeper<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${last.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>Add these dependencies in  springboot yaml file:</li>\n</ul>\n<pre><code class=\"language-yaml\"> <span class=\"hljs-attr\">soul :</span>\n     <span class=\"hljs-attr\">sync:</span>\n         <span class=\"hljs-attr\">zookeeper:</span>\n              <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">localhost:2181</span>\n              <span class=\"hljs-attr\">sessionTimeout:</span> <span class=\"hljs-number\">5000</span>\n              <span class=\"hljs-attr\">connectionTimeout:</span> <span class=\"hljs-number\">2000</span>\n <span class=\"hljs-comment\">#url: config with your zk address, used by the cluster environment, splitted with (,).</span>\n</code></pre>\n<ul>\n<li>soul-admin config: configure the soul-admin's starting parameter with <code>--soul.sync.zookeeper.url='your address'</code>,then restart the service.</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul:</span>\n  <span class=\"hljs-attr\">sync:</span>\n    <span class=\"hljs-attr\">zookeeper:</span>\n        <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">localhost:2181</span>\n        <span class=\"hljs-attr\">sessionTimeout:</span> <span class=\"hljs-number\">5000</span>\n        <span class=\"hljs-attr\">connectionTimeout:</span> <span class=\"hljs-number\">2000</span>\n</code></pre>\n<ul>\n<li>It is  good to use ZooKeeper synchronization mechanism with high timeliness, but we also have to deal with the unstable environment of ZK, cluster brain splitting and other\nproblems.</li>\n</ul>\n<h2>Http long-polling sync</h2>\n<ul>\n<li>\n<p>gateway setting（note:restart）</p>\n<ul>\n<li>Add these dependencies in <code>pom.xml</code>：</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">   <span class=\"hljs-comment\">&lt;!--soul data sync start use zookeeper--&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-sync-data-http<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${last.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>add these config values in your springboot yaml file:</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul :</span>\n   <span class=\"hljs-attr\">sync:</span>\n       <span class=\"hljs-attr\">http:</span>\n            <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">http://localhost:9095</span>\n<span class=\"hljs-comment\">#url: config with your soul-admin's ip and port url, pls use (,) to split multi-admin cluster environment.</span>\n</code></pre>\n<ul>\n<li>soul-admin config, configure the soul-admin's starting parameter with <code>--soul.sync.http=''</code>, then restart service.</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul:</span>\n  <span class=\"hljs-attr\">sync:</span>\n     <span class=\"hljs-attr\">http:</span>\n</code></pre>\n<ul>\n<li>\n<p>HTTP long-polling makes the gateway lightweight, but less time-sensitive.</p>\n</li>\n<li>\n<p>It pulls according to the group key, if the data is too large, it will have some influences, a small change under a group will pull the entire group.</p>\n</li>\n<li>\n<p>it may hit bug in soul-admin cluster.</p>\n</li>\n</ul>\n<h2>nacos sync</h2>\n<ul>\n<li>\n<p>gateway setting（note:restart）</p>\n<ul>\n<li>Add these dependencies in your <code>pom.xml</code>：</li>\n</ul>\n</li>\n</ul>\n<pre><code class=\"language-xml\">   <span class=\"hljs-comment\">&lt;!--soul data sync start use zookeeper--&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.dromara<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>soul-spring-boot-starter-sync-data-nacos<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n           <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${last.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre>\n<ul>\n<li>add these config values in the springboot yaml file:</li>\n</ul>\n<pre><code class=\"language-yaml\"> <span class=\"hljs-attr\">soul :</span>\n     <span class=\"hljs-attr\">sync:</span>\n        <span class=\"hljs-attr\">nacos:</span>\n             <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">localhost:8848</span>\n             <span class=\"hljs-attr\">namespace:</span> <span class=\"hljs-string\">1c10d748-af86-43b9-8265-75f487d20c6c</span>\n             <span class=\"hljs-attr\">acm:</span>\n               <span class=\"hljs-attr\">enabled:</span> <span class=\"hljs-literal\">false</span>\n               <span class=\"hljs-attr\">endpoint:</span> <span class=\"hljs-string\">acm.aliyun.com</span>\n               <span class=\"hljs-attr\">namespace:</span> \n               <span class=\"hljs-attr\">accessKey:</span> \n               <span class=\"hljs-attr\">secretKey:</span> \n <span class=\"hljs-comment\"># url: config with your nacos address, pls use (,) to split your cluster environment.</span>\n <span class=\"hljs-comment\"># other configure，pls refer to the naocs website.</span>\n</code></pre>\n<ul>\n<li>soul-admin config: passing values one by one with '--' operator in the soul-Admin startup parameter.</li>\n</ul>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">soul :</span>\n      <span class=\"hljs-attr\">sync:</span>\n         <span class=\"hljs-attr\">nacos:</span>\n              <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">localhost:8848</span>\n              <span class=\"hljs-attr\">namespace:</span> <span class=\"hljs-string\">1c10d748-af86-43b9-8265-75f487d20c6c</span>\n              <span class=\"hljs-attr\">acm:</span>\n                <span class=\"hljs-attr\">enabled:</span> <span class=\"hljs-literal\">false</span>\n                <span class=\"hljs-attr\">endpoint:</span> <span class=\"hljs-string\">acm.aliyun.com</span>\n                <span class=\"hljs-attr\">namespace:</span> \n                <span class=\"hljs-attr\">accessKey:</span> \n                <span class=\"hljs-attr\">secretKey:</span> \n</code></pre>\n",
  "link": "/en-us/docs/soul/user-dataSync.html",
  "meta": {
    "title": "use different data-sync strategy.",
    "keywords": "soul",
    "description": "use different data-sync strategy."
  }
}